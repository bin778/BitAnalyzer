#:import OrderBookWidget ui.order_book_widget.OrderBookWidget
#:import TrendGraphWidget ui.trend_graph_widget.TrendGraphWidget
#:import App kivy.app.App
#:import dp kivy.metrics.dp

<PriceTrackerLayout>:
    orientation: 'vertical'
    padding: dp(10)
    spacing: dp(5)

    Button:
        text: "< Back to Search"
        size_hint_y: None
        height: dp(40)
        background_color: (0.3, 0.3, 0.3, 1)
        on_release: App.get_running_app().switch_to_explorer()

    ScrollView:
        size_hint_y: 0.55
        do_scroll_x: True
        do_scroll_y: False
        bar_width: dp(10)
        
        BoxLayout:
            id: widgets_container
            orientation: 'horizontal'
            size_hint_x: None
            width: self.minimum_width
            spacing: dp(10)
            padding: dp(5)
            
            OrderBookWidget:
                id: slot_0
                size_hint_x: None
                width: dp(300)
            OrderBookWidget:
                id: slot_1
                size_hint_x: None
                width: dp(300)
            OrderBookWidget:
                id: slot_2
                size_hint_x: None
                width: dp(300)
            OrderBookWidget:
                id: slot_3
                size_hint_x: None
                width: dp(300)
            OrderBookWidget:
                id: slot_4
                size_hint_x: None
                width: dp(300)

    BoxLayout:
        orientation: 'vertical'
        size_hint_y: 0.45
        spacing: dp(5)
        
        Label:
            id: analysis_label
            text: "Kimchi Premium: Calculating..."
            font_size: '16sp'
            size_hint_y: 0.15
            color: (0.8, 0.8, 0.8, 1)

        TrendGraphWidget:
            id: trend_graph
            size_hint_y: 0.7
            
        BoxLayout:
            size_hint_y: 0.15
            spacing: dp(10)
            padding: (dp(20), 0)
            
            Button:
                text: "1D"
                on_release: root.update_graph_period('1D')
            Button:
                text: "1M"
                on_release: root.update_graph_period('1M')
            Button:
                text: "3M"
                on_release: root.update_graph_period('3M')
            Button:
                text: "1Y"
                on_release: root.update_graph_period('1Y')

        Label:
            id: timestamp_label
            text: "Last Updated: --:--:--"
            font_size: '11sp'
            size_hint_y: 0.1
            color: (0.5, 0.5, 0.5, 1)